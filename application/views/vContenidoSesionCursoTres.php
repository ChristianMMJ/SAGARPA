<!--Confirmacion-->
<div id="mdlConfirmar" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog  modal-content ">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Confirmación</h4>
        </div>
        <div class="modal-body">Deseas terminar el intento?</div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal" id="btnCancelarTerminar">CANCELAR</button>
            <button type="button" class="btn btn-raised btn-primary" id="btnTerminar">ACEPTAR</button>
        </div>
    </div>
</div>

<!--MODAL CUESTIONARIO-->
<div id="mdlCapturarExamen" class="modal modalFull fade " tabindex="-1" role="dialog">
    <div class="modal-dialog  modal-content modal-dialogFull">
        <div class="modal-header modal-headerFull">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title modal-titleFull">Evaluación Parcial 1</h4>
        </div>
        <div class="modal-body modal-bodyFull">
            <form id="frmCuestionario">
                <div class="col-12 col-md-12">
                    <p>1.   Puede considerarse como la fuerza que impulsa a los agentes productores a llevar a cabo su idea de negocio. Siendo esta idea el origen desde donde se toma cada decisión razonada y se implementa cada acción programada, que servirán para convertirla en realidad y con ello aspirar a obtener los beneficios esperados. </p>
                    <div class="form-group label-static ">
                        <div class="radio">
                            <label><input type="radio" name="Uno"  value="a" >a) Planeación</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Uno"  value="b" >b) Emprendimiento</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Uno"  value="c" >c)    Una idea</label>
                        </div>
                    </div>

                </div>
                <div class="col-12 col-md-12">
                    <p>2.   Representa la primera etapa de proceso de creación de un proyecto de negocio.</p>
                    <div class="form-group label-static ">
                        <div class="radio">
                            <label><input type="radio" name="Dos"  value="a" >a)  Etapa de emprendimiento</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Dos"  value="b" >b)  Etapa de planeación</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Dos"  value="c" >c)  Etapa de la idea</label>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-12">
                    <p>3.   Se expresa como una declaratoria de intención, donde se indica de manera clara y precisa, dónde se desea que esté el negocio en el largo plazo y los alcances que se desean tener.  </p>
                    <div class="form-group label-static ">
                        <div class="radio">
                            <label><input type="radio" name="Tres"  value="a" >a)  Visión</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Tres"  value="b" >b)  Misión</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Tres"  value="c" >c)  Objetivos</label>
                        </div>
                    </div>
                </div>

                <div class="col-12 col-md-12">
                    <p>4.   Este proceso consististe en recabar, organizar, sintetizar y analizar 
                        información relacionada con el negocio y su objetivo es identificar los factores 
                        positivos y negativos que influyen en el negocio, que pueden determinar 
                        su viabilidad y sus limitaciones. </p>
                    <div class="form-group label-static ">
                        <div class="radio">
                            <label><input type="radio" name="Cuatro"  value="a" >a) Objetivos estratégicos</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Cuatro"  value="b" >b) Diagnóstico empresarial</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Cuatro"  value="c" >c)    Análisis de riesgos</label>
                        </div>
                    </div>
                </div>

                <div class="col-12 col-md-12">
                    <p>5.   El efecto positivo o negativo en el negocio ante un factor externo, dependerá en gran medida de las condiciones internas de ésta.</p>
                    <div class="form-group label-static ">
                        <div class="radio">
                            <label><input type="radio" name="Cinco"  value="a" >a)   Falso</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Cinco"  value="b" >b)   Verdadero</label>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-12">
                    <p>6.   Se define como un sistema complejo en el que intervienen diversos 
                        agentes económicos como oferentes y demandantes, es un sistema 
                        dinámico porque además se ve influenciado permanentemente 
                        por distintos factores que determinan su comportamiento.</p>
                    <div class="form-group label-static ">
                        <div class="radio">
                            <label><input type="radio" name="Seis"  value="a" >a)  El negocio agroalimentario</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Seis"  value="b" >b)  El mercado</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Seis"  value="c" >c)  Ninguno de los anteriores</label>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-12">
                    <p>7.   El análisis del mercado y el entorno comercial integra por distintos factores como:</p>
                    <div class="form-group label-static ">
                        <div class="radio">
                            <label><input type="radio" name="Siete"  value="a" >a)   Proveedores, competidores, distribuidores y consumidores</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Siete"  value="b" >b)   Vendedores, clientes y repartidores</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Siete"  value="c" >c)  Productores, cadenas comerciales y consumidores finales</label>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-12">
                    <p>8.   El sistema de proceso de producción integra sistemáticamente los siguientes componentes:</p>
                    <div class="form-group label-static ">
                        <div class="radio">
                            <label><input type="radio" name="Ocho"  value="a" >a)    Productos, procesos e insumos</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Ocho"  value="b" >b)    Insumos, procesos, productos</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Ocho"  value="c" >c)   Insumos, productos y procesos</label>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-12">
                    <p>9.   Los requerimientos del negocio se pueden clasificar en cuatro componentes:</p>
                    <div class="form-group label-static ">
                        <div class="radio">
                            <label><input type="radio" name="Nueve"  value="a" >a)    Maquinaria y equipo, mano de obra, insumos y obra física</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Nueve"  value="b" >b)   Tierra, trabajo y capital</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Nueve"  value="c" >c)  Ninguna de las anteriores</label>
                        </div>

                    </div>
                </div>
                <div class="col-12 col-md-12">
                    <p>10.  En esta etapa del proceso de construcción de un proyecto, se definen las características del proyecto y luego la cuantifican sus costos y beneficios.</p>
                    <div class="form-group label-static ">
                        <div class="radio">
                            <label><input type="radio" name="Diez"  value="a" >a)    Etapa de idea</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Diez"  value="b" >b)    Etapa de formulación</label>
                        </div>
                        <div class="radio">
                            <label><input type="radio" name="Diez"  value="c" >c)   Etapa de evaluación</label>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer modal-footerFull">
            <button type="button" class="btn btn-default" data-dismiss="modal">CANCELAR</button>
            <button type="button" id="btnTerminarCaptura" class="btn btn-raised btn-primary">TERMINAR</button>
        </div>
    </div>
</div>


<!--NAVEGACION INTERNA-->
<div id="pnlContenidoSesionCursoTres" class="animated fadeInLeft">  
    <div class="col-md-12 dt-buttons" align="right">
        <a href="<?php print base_url('CtrlCurso'); ?>" type="button" class="btn btn-default">
            <span class="fa fa-arrow-left fa-1x"></span><br>REGRESAR
        </a>
    </div>
    <div class="col-md-12" align="center">
        <div class="panel panel-default">
            <div class="panel-body">
                <fieldset>
                    <div class="form-group label-static" id="aNotas">
                        <label for="Notas" class="control-label">Notas de la sesión</label>
                        <textarea class="col-md-12 form-control" placeholder="Introduzca aquí alguna observación de la sesión" id="Notas" name="Notas" rows="5" required=""></textarea>
                    </div>
                    <button id="btnIniciarExamen" type="button" class="btn btn-raised btn-primary" data-dismiss="modal">INICIAR EXAMEN</button>
                </fieldset>
            </div>
        </div>
    </div>
</div>

<script>
    var Nsesion = getCookie("sesion");
    var master_url = base_url + 'CtrlContenidoSesionCursoTres/';
    var master_urlCurso = base_url + 'CtrlCurso/';
    var idUsuario = "<?php echo $this->session->userdata('ID'); ?>";

    $(document).ready(function () {

        getObservacionesXSesion();

        $('#btnCancelarTerminar').on('click', function () {
            $('#mdlConfirmar').modal('hide');
            $('#mdlCapturarExamen').modal('show');


        });

        $('#btnTerminar').on('click', function () {
            //Validar calificación

            var Total = 0;
            if ($('input[name=Uno]:checked').val() === 'b') {
                Total = Total + 1;
            }
            if ($('input[name=Dos]:checked').val() === 'c') {
                Total = Total + 1;
            }
            if ($('input[name=Tres]:checked').val() === 'a') {
                Total = Total + 1;
            }
            if ($('input[name=Cuatro]:checked').val() === 'b') {
                Total = Total + 1;
            }
            if ($('input[name=Cinco]:checked').val() === 'b') {
                Total = Total + 1;
            }
            if ($('input[name=Seis]:checked').val() === 'b') {
                Total = Total + 1;
            }
            if ($('input[name=Siete]:checked').val() === 'a') {
                Total = Total + 1;
            }
            if ($('input[name=Ocho]:checked').val() === 'b') {
                Total = Total + 1;
            }
            if ($('input[name=Nueve]:checked').val() === 'a') {
                Total = Total + 1;
            }
            if ($('input[name=Diez]:checked').val() === 'b') {
                Total = Total + 1;
            }
            if (Total >= 8) {
                //Aquí se hace el update de estatus a finalizados de las primeras 3 sesiones y se inserta la 4ta

                alert('¡Felicidades! \n Haz aprobado el examen con una calificación de: ' + Total);
                $('#mdlConfirmar').modal('hide');
                $.ajax({
                    url: master_urlCurso + 'onModificarEstatusAnteriores',
                    type: "POST",
                    data: {
                        Sesion: Nsesion,
                        Calificacion: Total
                    }
                }).done(function (data, x, jq) {
                }).fail(function (x, y, z) {
                    console.log(x, y, z);
                }).always(function () {
                });

                var frm = new FormData();
                frm.append('Usuario_ID', idUsuario);
                frm.append('NSesion', 4);
                frm.append('Estatus', 'Activa');

                $.ajax({
                    url: master_urlCurso + 'onAgregar',
                    type: "POST",
                    cache: false,
                    contentType: false,
                    processData: false,
                    data: frm
                }).done(function (data, x, jq) {
                    document.cookie = "sesion=" + 4 + " ";
                    window.location.href = "<?php echo base_url('CtrlCurso'); ?>";
                }).fail(function (x, y, z) {
                    console.log(x, y, z);
                }).always(function () {
                    HoldOn.close();
                });

            } else {
                alert('¡Lo sentimos! \n La calificación mínima es de 8 y haz conseguido sólo ' + Total + ' puntos.');
                window.location.href = "<?php echo base_url('CtrlCurso'); ?>";

            }



        });

        $('#btnTerminarCaptura').on('click', function () {

            $.validator.setDefaults({
                ignore: []
            });
            $('#frmCuestionario').validate({
                errorElement: 'span',
                errorClass: 'help-block',

                rules: {
                    Uno: 'required',
                    Dos: 'required',
                    Tres: 'required',
                    Cuatro: 'required',
                    Cinco: 'required',
                    Seis: 'required',
                    Siete: 'required',
                    Ocho: 'required',
                    Nueve: 'required',
                    Diez: 'required'

                },
                highlight: function (element, errorClass, validClass) {
                    $(element).closest('.form-group').addClass('has-error has-errorTest');
                },
                unhighlight: function (element, errorClass, validClass) {
                    $(element).closest('.form-group').removeClass('has-error has-errorTest');
                }
            });
            //Regresa si es valido para los select2
            $('select').on('change', function () {
                $(this).valid();
            });
            if ($('#frmCuestionario').valid()) {
                $('#mdlCapturarExamen').modal('hide');
                $('#mdlConfirmar').modal('show');

            }
        });

        $('#btnIniciarExamen').on('click', function () {
            //Guarda las observaciones
            $.ajax({
                url: master_urlCurso + 'onModificar',
                type: "POST",
                data: {
                    Sesion: Nsesion,
                    Observaciones: $("#Notas").val()
                }
            }).done(function (data, x, jq) {

            }).fail(function (x, y, z) {
                console.log(x, y, z);
            }).always(function () {
            });
            $('#mdlCapturarExamen').modal('show');

        });

        if (parseInt(Nsesion) !== 3) {

            $('#aNotas').addClass('hide');
            $('#btnFinalizarSesion').addClass('hide');
            $('input[type="text"], textarea').attr('readonly', 'readonly');
        }

    });

    function getObservacionesXSesion() {

        $.ajax({
            url: master_urlCurso + 'getObservacionesXSesion',
            type: "POST",
            dataType: "JSON",
            data: {
                Sesion: Nsesion
            }
        }).done(function (data, x, jq) {
            console.log(data);
            $('#Notas').val(data[0].Observaciones);

        }).fail(function (x, y, z) {
            console.log(x, y, z);
        }).always(function () {
        });


    }


</script>